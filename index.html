<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sant√©+ - Plateforme de sant√© professionnelle</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* =========================================================
      THEME TOKENS
      - light is default
      - dark is applied by: <html data-theme="dark">
    ========================================================= */
    :root{
      --bg-1:#f5f9ff; --bg-2:#edf4ff; --bg-3:#eef2ff;
      --card:rgba(255,255,255,.92);
      --cardSolid:#ffffff;
      --text:#0f172a; --muted:#475569; --muted2:#64748b;
      --primary:#2563eb; --accent:#4f46e5;
      --border:rgba(148,163,184,.35);
      --ring:rgba(37,99,235,.25);
      --shadow-sm:0 1px 2px rgba(15,23,42,.06);
      --shadow-md:0 10px 20px rgba(15,23,42,.08);
      --r-lg:16px;

      --good-bg:#ecfdf5; --good-bd:#bbf7d0; --good-tx:#166534;
      --warn-bg:#fffbeb; --warn-bd:#fde68a; --warn-tx:#92400e;
      --bad-bg:#fef2f2;  --bad-bd:#fecaca;  --bad-tx:#991b1b;
      --info-bg:#eff6ff; --info-bd:#bfdbfe; --info-tx:#1e40af;

      --tabBg: rgba(37,99,235,.08);
      --tabBd: rgba(37,99,235,.12);
      --cardBd: rgba(148,163,184,.22);
      --tableHeadBg: rgba(37,99,235,.06);
      --rowHover: rgba(37,99,235,.05);
      --icon: #334155;
      --headerBg: rgba(255,255,255,.72);
    }

    html[data-theme="dark"]{
      --bg-1:#0b1220; --bg-2:#0b1220; --bg-3:#0f172a;
      --card: rgba(17,24,39,.72);
      --cardSolid:#111827;
      --text:#e5e7eb; --muted:#cbd5e1; --muted2:#94a3b8;
      --border: rgba(148,163,184,.18);
      --shadow-sm: 0 1px 2px rgba(0,0,0,.35);
      --shadow-md: 0 16px 30px rgba(0,0,0,.35);

      --tabBg: rgba(255,255,255,.06);
      --tabBd: rgba(255,255,255,.10);
      --cardBd: rgba(255,255,255,.10);
      --tableHeadBg: rgba(255,255,255,.06);
      --rowHover: rgba(255,255,255,.05);
      --icon: #cbd5e1;
      --headerBg: rgba(17,24,39,.72);
    }

    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background:
        radial-gradient(1000px 600px at 15% 10%, rgba(37,99,235,.12), transparent 55%),
        radial-gradient(900px 500px at 85% 20%, rgba(79,70,229,.12), transparent 60%),
        linear-gradient(135deg, var(--bg-1) 0%, var(--bg-2) 45%, var(--bg-3) 100%);
      min-height:100vh;
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Header */
    .header{
      position: sticky; top:0; z-index:10;
      background: var(--headerBg);
      backdrop-filter: blur(14px);
      border-bottom: 1px solid var(--border);
      box-shadow: var(--shadow-sm);
    }
    .header-content{
      max-width:1600px; margin:0 auto;
      padding: 14px 24px;
      display:flex; align-items:center; justify-content:space-between;
      gap:16px;
    }
    .logo{display:flex; align-items:center; gap:12px; min-width:260px;}
    .logo-icon{
      width:42px;height:42px;border-radius:14px;
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      box-shadow: 0 10px 18px rgba(37,99,235,.20);
      border: 1px solid rgba(255,255,255,.25);
    }
    .logo-icon i{color:#fff;font-size:20px}
    .logo-text h1{font-size:16px;font-weight:900;letter-spacing:.2px;line-height:1.1}
    .logo-text p{font-size:12px;color:var(--muted2);margin-top:2px;font-weight:600}

    .header-actions{display:flex;align-items:center;gap:8px}
    .icon-btn{
      width:40px;height:40px;border-radius:10px;
      border:1px solid transparent;background:transparent;
      display:flex;align-items:center;justify-content:center;
      cursor:pointer; transition:.2s;
      color: var(--icon);
    }
    .icon-btn:hover{background: rgba(37,99,235,.08); border-color: rgba(37,99,235,.15)}
    .icon-btn:focus-visible{outline:none; box-shadow:0 0 0 4px var(--ring); border-color: rgba(37,99,235,.35)}
    .icon-btn i{color:var(--icon);font-size:16px}

    .container{max-width:1600px;margin:0 auto;padding: 22px 24px 52px;}

    .page-header{margin: 18px 0 18px;}
    .page-header h2{font-size:34px;font-weight:950;letter-spacing:-.4px;margin-bottom:6px}
    .page-header p{font-size:15px;color:var(--muted);font-weight:600}

    .tabsbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin: 12px 0 18px;
    }
    .hint{
      color: var(--muted2);
      font-size: 12px;
      font-weight: 700;
    }

    .tabs{
      position: relative;
      display:flex; gap:6px;
      background: var(--tabBg);
      border:1px solid var(--tabBd);
      padding:6px;
      border-radius: 14px;
      overflow: hidden;
    }
    .tab-indicator{
      position:absolute;
      top:6px;
      left:6px;
      height: calc(100% - 12px);
      width: 120px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      box-shadow: 0 10px 18px rgba(37,99,235,.18);
      transition: transform .22s ease, width .22s ease;
      z-index: 0;
    }
    .tab{
      position: relative;
      z-index: 1;
      display:flex; align-items:center; gap:10px;
      padding: 10px 14px;
      border-radius: 12px;
      border:1px solid transparent;
      background: transparent;
      color: var(--icon);
      cursor:pointer;
      font-weight:900;
      font-size: 13px;
      letter-spacing:.1px;
      transition: color .2s, background .2s, border-color .2s;
      white-space:nowrap;
      user-select:none;
    }
    .tab i{font-size:14px; opacity:.9}
    .tab:hover{ background: rgba(255,255,255,.10); border-color: rgba(148,163,184,.22); }
    html[data-theme="light"] .tab:hover{ background: rgba(255,255,255,.55); }
    .tab[aria-selected="true"]{ color:#fff; }
    .tab:focus-visible{ outline:none; box-shadow:0 0 0 4px var(--ring); }

    .page{
      display:none;
      border-radius: var(--r-lg);
      background: var(--card);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-md);
      padding: 18px;
      opacity: 0;
      transform: translateY(10px);
    }
    .page.active{ display:block; animation: pageIn .22s ease forwards; }
    @keyframes pageIn{ to{ opacity:1; transform: translateY(0); } }

    .grid-2{display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap:14px}
    .grid-auto{display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:14px}

    .card{
      background: rgba(255,255,255,.10);
      border:1px solid var(--cardBd);
      border-radius: 14px;
      padding: 14px;
      box-shadow: var(--shadow-sm);
    }
    html[data-theme="light"] .card{
      background: rgba(255,255,255,.85);
      border-color: rgba(148,163,184,.22);
    }

    .section-head{
      display:flex; align-items:flex-end; justify-content:space-between;
      gap:14px; margin-bottom: 12px;
    }
    .section-head h3{ font-size:18px; font-weight:950; letter-spacing:-.2px; }
    .section-head p{ color: var(--muted); font-weight:650; font-size: 13px; }

    .card-title{
      font-size:12px;
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:.12px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .card-title i{color: var(--primary)}
    .big{ font-size:28px; font-weight:950; margin-top:10px; letter-spacing:-.2px; }
    .sub{ font-size:12px; color:var(--muted2); font-weight:700; margin-top:2px; }

    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid;
      font-weight:900;
      font-size:12px;
      letter-spacing:.1px;
      white-space:nowrap;
    }
    .badge i{font-size:12px}
    .b-good{ background:var(--good-bg); border-color:var(--good-bd); color:var(--good-tx); }
    .b-warn{ background:var(--warn-bg); border-color:var(--warn-bd); color:var(--warn-tx); }
    .b-bad { background:var(--bad-bg);  border-color:var(--bad-bd);  color:var(--bad-tx);  }
    .b-info{ background:var(--info-bg); border-color:var(--info-bd); color:var(--info-tx); }

    .btn{
      display:inline-flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid rgba(37,99,235,.22);
      background: rgba(255,255,255,.10);
      cursor:pointer;
      font-weight:900;
      color:#93c5fd;
      transition:.2s;
      user-select:none;
    }
    html[data-theme="light"] .btn{
      background: rgba(255,255,255,.7);
      color:#1d4ed8;
    }
    .btn:hover{ background: rgba(37,99,235,.12); }
    .btn:focus-visible{ outline:none; box-shadow:0 0 0 4px var(--ring); }
    .btn-primary{
      border-color: transparent;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color:#fff;
      box-shadow: 0 10px 18px rgba(37,99,235,.18);
    }

    .row{ display:flex; gap:10px; flex-wrap: wrap; align-items:center; }

    .input{
      flex: 1 1 260px;
      min-width: 220px;
      display:flex; align-items:center; gap:10px;
      background: rgba(255,255,255,.10);
      border:1px solid var(--cardBd);
      border-radius: 12px;
      padding: 10px 12px;
      box-shadow: var(--shadow-sm);
    }
    html[data-theme="light"] .input{
      background: rgba(255,255,255,.85);
      border-color: rgba(148,163,184,.25);
    }
    .input i{ color: var(--muted2); }
    .input select{
      border: none;
      outline: none;
      background: transparent;
      width: 100%;
      color: var(--text);
      font-weight: 750;
      font-size: 13px;
    }

    table{
      width:100%;
      border-collapse: collapse;
      background: rgba(255,255,255,.10);
      border:1px solid var(--cardBd);
      border-radius: 14px;
      overflow:hidden;
      box-shadow: var(--shadow-sm);
    }
    html[data-theme="light"] table{
      background: rgba(255,255,255,.85);
      border-color: rgba(148,163,184,.22);
    }
    thead th{
      text-align:left;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.12px;
      color:var(--muted);
      padding: 12px 12px;
      background: var(--tableHeadBg);
      border-bottom: 1px solid var(--border);
    }
    tbody td{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(148,163,184,.14);
      font-weight: 700;
      color: var(--text);
      font-size: 13px;
    }
    tbody tr:hover{ background: var(--rowHover); }
    tbody tr:last-child td{ border-bottom:none; }

    .chart{ height: 320px; padding: 10px; }
    .chart canvas{ width:100% !important; height:100% !important; }

    @media (max-width: 1100px){ .grid-2{ grid-template-columns: 1fr; } }
    @media (max-width: 900px){
      .tabsbar{flex-direction:column; align-items:flex-start}
      .page-header h2{font-size:28px}
      .logo{min-width:auto}
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon"><i class="fas fa-heartbeat"></i></div>
        <div class="logo-text">
          <h1>Sant√©+</h1>
          <p data-i18n="app.subtitle">Plateforme de sant√© professionnelle</p>
        </div>
      </div>

      <div class="header-actions">
        <button class="icon-btn" aria-label="Notifications"><i class="fas fa-bell"></i></button>
        <button class="icon-btn" aria-label="Param√®tres"><i class="fas fa-cog"></i></button>
        <button class="icon-btn" aria-label="Profil"><i class="fas fa-user"></i></button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="page-header">
      <h2 data-i18n="header.greeting">Bonjour, Dr. Victor Mouhammad üëã</h2>
      <p data-i18n="header.subline">Dossier m√©dical complet - Mardi 14 Janvier 2026</p>
    </div>

    <div class="tabsbar">
      <div class="tabs" role="tablist" aria-label="Navigation">
        <div class="tab-indicator" id="tabIndicator" aria-hidden="true"></div>

        <button class="tab" role="tab" data-page="dashboard" aria-selected="true" aria-controls="page-dashboard">
          <i class="fas fa-chart-line"></i> <span data-i18n="tabs.dashboard">Dashboard</span>
        </button>

        <button class="tab" role="tab" data-page="capteurs" aria-selected="false" aria-controls="page-capteurs">
          <i class="fas fa-wave-square"></i> <span data-i18n="tabs.sensors">Capteurs</span>
        </button>

        <button class="tab" role="tab" data-page="historique" aria-selected="false" aria-controls="page-historique">
          <i class="fas fa-clock-rotate-left"></i> <span data-i18n="tabs.history">Historique</span>
        </button>

        <button class="tab" role="tab" data-page="settings" aria-selected="false" aria-controls="page-settings">
          <i class="fas fa-message"></i> <span data-i18n="tabs.messages">Messages</span>
        </button>
      </div>

      <div class="hint" data-i18n="hint">Astuce : touches ‚Üê ‚Üí + Enter/Espace ‚Ä¢ URL #page</div>
    </div>

    <!-- DASHBOARD -->
    <section id="page-dashboard" class="page active" role="tabpanel" aria-label="Dashboard">
      <div class="section-head">
        <div>
          <h3 data-i18n="dash.title">Activit√© & Fr√©quence</h3>
          <p data-i18n="dash.subtitle">R√©sum√© des tendances : activit√© quotidienne et fr√©quence cardiaque.</p>
        </div>
        <div class="row">
          <span class="badge b-info"><i class="fas fa-circle-info"></i> <span data-i18n="dash.session">Session active</span></span>
          <button class="btn btn-primary" type="button"><i class="fas fa-file-export"></i> <span data-i18n="dash.export">Export</span></button>
        </div>
      </div>

      <div class="grid-auto">
        <div class="card">
          <div class="card-title"><i class="fas fa-heart"></i> <span data-i18n="dash.hr">Fr√©quence cardiaque</span></div>
          <div class="big" id="kpiHr">72</div>
          <div class="sub"><span data-i18n="dash.hrSub">bpm ‚Ä¢ derni√®re mesure 08:30</span></div>
          <div style="margin-top:10px"><span class="badge b-good"><i class="fas fa-check"></i> <span data-i18n="status.normal">Normal</span></span></div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-person-walking"></i> <span data-i18n="dash.activity">Activit√© (pas)</span></div>
          <div class="big" id="kpiSteps">6 420</div>
          <div class="sub"><span data-i18n="dash.activitySub">pas aujourd‚Äôhui ‚Ä¢ objectif 8 000</span></div>
          <div style="margin-top:10px"><span class="badge b-info"><i class="fas fa-bullseye"></i> <span data-i18n="dash.goal">80% atteint</span></span></div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-fire"></i> <span data-i18n="dash.calories">Calories estim√©es</span></div>
          <div class="big" id="kpiCal">420</div>
          <div class="sub"><span data-i18n="dash.caloriesSub">kcal aujourd‚Äôhui ‚Ä¢ estimation</span></div>
          <div style="margin-top:10px"><span class="badge b-info"><i class="fas fa-chart-line"></i> <span data-i18n="dash.stable">Stable</span></span></div>
        </div>
      </div>

      <div style="margin-top:14px" class="grid-2">
        <div class="card">
          <div class="section-head" style="margin-bottom:10px">
            <div>
              <h3 style="font-size:16px" data-i18n="dash.hr7">Fr√©quence cardiaque (7 jours)</h3>
              <p style="margin-top:2px" data-i18n="dash.hr7Sub">BPM moyen par jour.</p>
            </div>
            <span class="badge b-info"><i class="fas fa-calendar"></i> <span data-i18n="common.week">Semaine</span></span>
          </div>
          <div class="chart"><canvas id="dashHeart"></canvas></div>
        </div>

        <div class="card">
          <div class="section-head" style="margin-bottom:10px">
            <div>
              <h3 style="font-size:16px" data-i18n="dash.act7">Activit√© (7 jours)</h3>
              <p style="margin-top:2px" data-i18n="dash.act7Sub">Pas par jour.</p>
            </div>
            <span class="badge b-info"><i class="fas fa-calendar"></i> <span data-i18n="common.week">Semaine</span></span>
          </div>
          <div class="chart"><canvas id="dashActivity"></canvas></div>
        </div>
      </div>
    </section>

    <!-- CAPTEURS -->
    <section id="page-capteurs" class="page" role="tabpanel" aria-label="Capteurs">
      <div class="section-head">
        <div>
          <h3 data-i18n="sensors.title">Capteurs</h3>
          <p data-i18n="sensors.subtitle">√âvolution de la pression art√©rielle (d√©mo). Remplace par tes valeurs r√©elles.</p>
        </div>
        <div class="row">
          <span class="badge b-info"><i class="fas fa-microchip"></i> <span data-i18n="sensors.pi">Raspberry Pi 4</span></span>
          <span class="badge b-info"><i class="fas fa-wave-square"></i> 400 Hz</span>
          <button class="btn btn-primary" type="button" id="btnStartDemo"><i class="fas fa-play"></i> <span data-i18n="common.demo">D√©mo</span></button>
          <button class="btn" type="button" id="btnStopDemo"><i class="fas fa-stop"></i> <span data-i18n="common.stop">Stop</span></button>
        </div>
      </div>

      <div class="grid-auto">
        <div class="card">
          <div class="card-title"><i class="fas fa-heart-pulse"></i> <span data-i18n="sensors.bpNow">Tension actuelle</span></div>
          <div class="big"><span id="bpNow">120/80</span></div>
          <div class="sub"><span data-i18n="sensors.bpNowSub">mmHg ‚Ä¢ derni√®re mise √† jour</span> <span id="tick">‚Äî</span></div>
          <div style="margin-top:10px"><span class="badge b-good" id="bpStatus"><i class="fas fa-check"></i> <span data-i18n="status.normal">Normal</span></span></div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-heart"></i> <span data-i18n="sensors.bpmDemo">BPM (d√©mo)</span></div>
          <div class="big"><span id="bpmNow">72</span></div>
          <div class="sub" data-i18n="sensors.bpmDemoSub">bpm instantan√© (exemple)</div>
          <div style="margin-top:10px"><span class="badge b-info"><i class="fas fa-circle-info"></i> <span data-i18n="sensors.simulated">Donn√©es simul√©es</span></span></div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-person-walking"></i> <span data-i18n="sensors.pir">Pr√©sence (PIR)</span></div>
          <div class="big" id="pirNow" data-i18n="sensors.none">Aucune</div>
          <div class="sub" data-i18n="sensors.pirSub">d√©tection mouvement</div>
          <div style="margin-top:10px" class="row">
            <span class="badge b-info"><i class="fas fa-bolt"></i> 5V</span>
            <span class="badge b-info"><i class="fas fa-circle-info"></i> Digital</span>
          </div>
        </div>
      </div>

      <div style="margin-top:14px" class="grid-2">
        <div class="card">
          <div class="section-head" style="margin-bottom:10px">
            <div>
              <h3 style="font-size:16px" data-i18n="sensors.bpTrend">√âvolution pression art√©rielle</h3>
              <p style="margin-top:2px" data-i18n="sensors.bpTrendSub">Systolique / Diastolique (d√©mo).</p>
            </div>
            <span class="badge b-info"><i class="fas fa-chart-line"></i> Graph</span>
          </div>
          <div class="chart"><canvas id="bpChart"></canvas></div>
        </div>

        <div class="card">
          <div class="section-head" style="margin-bottom:10px">
            <div>
              <h3 style="font-size:16px" data-i18n="sensors.diag">Diagnostic rapide</h3>
              <p style="margin-top:2px" data-i18n="sensors.diagSub">R√©sultats et actions recommand√©es.</p>
            </div>
          </div>

          <div class="card" style="margin-bottom:10px">
            <div class="row" style="justify-content:space-between">
              <div style="font-weight:900" data-i18n="sensors.range">Tension (plage attendue)</div>
              <span class="badge b-good"><i class="fas fa-check"></i> OK</span>
            </div>
            <div class="sub" style="margin-top:6px" data-i18n="sensors.rangeTip">
              Conseil : refaire une mesure apr√®s 2 minutes de repos si valeur √©lev√©e.
            </div>
          </div>

          <div class="card" style="margin-bottom:10px">
            <div class="row" style="justify-content:space-between">
              <div style="font-weight:900" data-i18n="sensors.pirCheck">Pr√©sence PIR</div>
              <span class="badge b-info"><i class="fas fa-circle-info"></i> <span data-i18n="common.variable">Variable</span></span>
            </div>
            <div class="sub" style="margin-top:6px" data-i18n="sensors.pirTip">
              Conseil : √©viter sources de chaleur / mouvements parasites.
            </div>
          </div>

          <div class="row">
            <button class="btn" type="button"><i class="fas fa-rotate"></i> <span data-i18n="common.recalibrate">Recalibrer</span></button>
            <button class="btn" type="button"><i class="fas fa-file-lines"></i> <span data-i18n="common.logs">Logs</span></button>
          </div>
        </div>
      </div>
    </section>

    <!-- HISTORIQUE -->
    <section id="page-historique" class="page" role="tabpanel" aria-label="Historique">
      <div class="section-head">
        <div>
          <h3 data-i18n="history.title">Historique des patients</h3>
          <p data-i18n="history.subtitle">Historique des mesures et √©v√©nements.</p>
        </div>
        <div class="row">
          <span class="badge b-info"><i class="fas fa-clock"></i> <span data-i18n="common.days7">7 jours</span></span>
          <button class="btn btn-primary" type="button"><i class="fas fa-download"></i> <span data-i18n="history.exportCsv">Export CSV</span></button>
        </div>
      </div>

      <table aria-label="Historique patients">
        <thead>
          <tr>
            <th data-i18n="history.patient">Patient</th>
            <th data-i18n="history.date">Date</th>
            <th>BPM</th>
            <th data-i18n="history.bp">Pression</th>
            <th>SpO‚ÇÇ</th>
            <th data-i18n="history.status">Statut</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Waly</td>
            <td>14/01/2026 ‚Ä¢ 08:30</td>
            <td>74</td>
            <td>121/79</td>
            <td>98%</td>
            <td><span class="badge b-good"><i class="fas fa-check"></i> <span data-i18n="status.normal">Normal</span></span></td>
          </tr>
          <tr>
            <td>Binaf</td>
            <td>13/01/2026 ‚Ä¢ 17:10</td>
            <td>88</td>
            <td>135/86</td>
            <td>96%</td>
            <td><span class="badge b-warn"><i class="fas fa-triangle-exclamation"></i> <span data-i18n="status.watch">√Ä surveiller</span></span></td>
          </tr>
          <tr>
            <td>Messaoud</td>
            <td>12/01/2026 ‚Ä¢ 09:05</td>
            <td>69</td>
            <td>118/76</td>
            <td>99%</td>
            <td><span class="badge b-good"><i class="fas fa-check"></i> <span data-i18n="status.normal">Normal</span></span></td>
          </tr>
          <tr>
            <td>Waly</td>
            <td>11/01/2026 ‚Ä¢ 15:20</td>
            <td>92</td>
            <td>142/90</td>
            <td>95%</td>
            <td><span class="badge b-bad"><i class="fas fa-bell"></i> <span data-i18n="status.alert">Alerte</span></span></td>
          </tr>
        </tbody>
      </table>

      <div class="card" style="margin-top:14px">
        <div class="section-head" style="margin-bottom:10px">
          <div>
            <h3 style="font-size:16px" data-i18n="history.notes">Notes</h3>
            <p style="margin-top:2px" data-i18n="history.notesSub">Commentaires associ√©s aux mesures.</p>
          </div>
        </div>
        <div class="sub" data-i18n="history.notesBody">
          ‚Ä¢ Waly : refaire la tension apr√®s repos, v√©rifier hydratation.<br>
          ‚Ä¢ Binaf : surveillance glyc√©mie + tension, programmer contr√¥le.<br>
          ‚Ä¢ Messaoud : param√®tres stables, poursuivre suivi standard.
        </div>
      </div>
    </section>

    <!-- SETTINGS / MESSAGES + THEME + LANGUAGE -->
    <section id="page-settings" class="page" role="tabpanel" aria-label="Messages">
      <div class="section-head">
        <div>
          <h3 data-i18n="msg.title">Messages patient</h3>
          <p data-i18n="msg.subtitle">Exemples de messages automatiques possibles (SMS / notification / email).</p>
        </div>
        <div class="row">
          <span class="badge b-info"><i class="fas fa-message"></i> <span data-i18n="msg.templates">Templates</span></span>
          <button class="btn btn-primary" type="button"><i class="fas fa-floppy-disk"></i> <span data-i18n="common.save">Enregistrer</span></button>
        </div>
      </div>

      <!-- REAL SETTINGS -->
      <div class="card" style="margin-bottom:14px">
        <div class="section-head" style="margin-bottom:10px">
          <div>
            <h3 style="font-size:16px" data-i18n="prefs.title">Pr√©f√©rences</h3>
            <p style="margin-top:2px" data-i18n="prefs.subtitle">Th√®me et langue appliqu√©s imm√©diatement.</p>
          </div>
        </div>

        <div class="row">
          <div class="input" style="flex:0 1 260px">
            <i class="fas fa-palette"></i>
            <select id="themeSelect" aria-label="Th√®me">
              <option value="light" data-i18n="prefs.themeLight">Th√®me : Clair</option>
              <option value="dark" data-i18n="prefs.themeDark">Th√®me : Sombre</option>
            </select>
          </div>

          <div class="input" style="flex:0 1 260px">
            <i class="fas fa-language"></i>
            <select id="langSelect" aria-label="Langue">
              <option value="fr">Langue : Fran√ßais</option>
              <option value="en">Language : English</option>
            </select>
          </div>

          <span class="badge b-info"><i class="fas fa-circle-info"></i> <span data-i18n="prefs.saved">Sauvegard√© automatiquement</span></span>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="card-title"><i class="fas fa-check"></i> <span data-i18n="msg.normalTitle">Message ‚ÄúR√©sultats normaux‚Äù</span></div>
          <div style="margin-top:10px;font-weight:850" data-i18n="msg.normalBody">
            Bonjour {patient}, vos mesures du {date} sont normales.
          </div>
          <div class="sub" style="margin-top:8px" data-i18n="msg.normalSub">
            BPM: {bpm} ‚Ä¢ Tension: {bp} ‚Ä¢ SpO‚ÇÇ: {spo2}. Continuez vos habitudes.
          </div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-triangle-exclamation"></i> <span data-i18n="msg.watchTitle">Message ‚Äú√Ä surveiller‚Äù</span></div>
          <div style="margin-top:10px;font-weight:850" data-i18n="msg.watchBody">
            Bonjour {patient}, certaines valeurs sont √† surveiller ({valeur}).
          </div>
          <div class="sub" style="margin-top:8px" data-i18n="msg.watchSub">
            Merci de refaire une mesure dans 10 minutes au repos. Si cela persiste, contactez le cabinet.
          </div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-bell"></i> <span data-i18n="msg.alertTitle">Message ‚ÄúAlerte‚Äù</span></div>
          <div style="margin-top:10px;font-weight:850" data-i18n="msg.alertBody">
            Bonjour {patient}, une valeur critique a √©t√© d√©tect√©e ({valeur}).
          </div>
          <div class="sub" style="margin-top:8px" data-i18n="msg.alertSub">
            Merci de contacter imm√©diatement un professionnel de sant√© ou les urgences selon votre √©tat.
          </div>
        </div>

        <div class="card">
          <div class="card-title"><i class="fas fa-calendar-check"></i> <span data-i18n="msg.reminderTitle">Message ‚ÄúRappel‚Äù</span></div>
          <div style="margin-top:10px;font-weight:850" data-i18n="msg.reminderBody">
            Bonjour {patient}, rappel : mesure / contr√¥le pr√©vu le {date} √† {heure}.
          </div>
          <div class="sub" style="margin-top:8px" data-i18n="msg.reminderSub">
            Merci d‚Äô√™tre au repos 5 minutes avant la mesure et d‚Äô√©viter caf√©/effort.
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // =========================================================
    // I18N DICTIONARY (FR/EN)
    // =========================================================
    const I18N = {
      fr: {
        "app.subtitle":"Plateforme de sant√© professionnelle",
        "header.greeting":"Bonjour, Dr. Victor Mouhammad üëã",
        "header.subline":"Dossier m√©dical complet - Mardi 14 Janvier 2026",
        "hint":"Astuce : touches ‚Üê ‚Üí + Enter/Espace ‚Ä¢ URL #page",

        "tabs.dashboard":"Dashboard",
        "tabs.sensors":"Capteurs",
        "tabs.history":"Historique",
        "tabs.messages":"Messages",

        "dash.title":"Activit√© & Fr√©quence",
        "dash.subtitle":"R√©sum√© des tendances : activit√© quotidienne et fr√©quence cardiaque.",
        "dash.session":"Session active",
        "dash.export":"Export",
        "dash.hr":"Fr√©quence cardiaque",
        "dash.hrSub":"bpm ‚Ä¢ derni√®re mesure 08:30",
        "dash.activity":"Activit√© (pas)",
        "dash.activitySub":"pas aujourd‚Äôhui ‚Ä¢ objectif 8 000",
        "dash.goal":"80% atteint",
        "dash.calories":"Calories estim√©es",
        "dash.caloriesSub":"kcal aujourd‚Äôhui ‚Ä¢ estimation",
        "dash.stable":"Stable",
        "dash.hr7":"Fr√©quence cardiaque (7 jours)",
        "dash.hr7Sub":"BPM moyen par jour.",
        "dash.act7":"Activit√© (7 jours)",
        "dash.act7Sub":"Pas par jour.",

        "sensors.title":"Capteurs",
        "sensors.subtitle":"√âvolution de la pression art√©rielle (d√©mo). Remplace par tes valeurs r√©elles.",
        "sensors.pi":"Raspberry Pi 4",
        "sensors.bpNow":"Tension actuelle",
        "sensors.bpNowSub":"mmHg ‚Ä¢ derni√®re mise √† jour",
        "sensors.bpmDemo":"BPM (d√©mo)",
        "sensors.bpmDemoSub":"bpm instantan√© (exemple)",
        "sensors.simulated":"Donn√©es simul√©es",
        "sensors.pir":"Pr√©sence (PIR)",
        "sensors.none":"Aucune",
        "sensors.pirSub":"d√©tection mouvement",
        "sensors.bpTrend":"√âvolution pression art√©rielle",
        "sensors.bpTrendSub":"Systolique / Diastolique (d√©mo).",
        "sensors.diag":"Diagnostic rapide",
        "sensors.diagSub":"R√©sultats et actions recommand√©es.",
        "sensors.range":"Tension (plage attendue)",
        "sensors.rangeTip":"Conseil : refaire une mesure apr√®s 2 minutes de repos si valeur √©lev√©e.",
        "sensors.pirCheck":"Pr√©sence PIR",
        "sensors.pirTip":"Conseil : √©viter sources de chaleur / mouvements parasites.",

        "history.title":"Historique des patients",
        "history.subtitle":"Historique des mesures et √©v√©nements.",
        "history.exportCsv":"Export CSV",
        "history.patient":"Patient",
        "history.date":"Date",
        "history.bp":"Pression",
        "history.status":"Statut",
        "history.notes":"Notes",
        "history.notesSub":"Commentaires associ√©s aux mesures.",
        "history.notesBody":"‚Ä¢ Waly : refaire la tension apr√®s repos, v√©rifier hydratation.<br>‚Ä¢ Binaf : surveillance glyc√©mie + tension, programmer contr√¥le.<br>‚Ä¢ Messaoud : param√®tres stables, poursuivre suivi standard.",

        "msg.title":"Messages patient",
        "msg.subtitle":"Exemples de messages automatiques possibles (SMS / notification / email).",
        "msg.templates":"Templates",
        "msg.normalTitle":"Message ‚ÄúR√©sultats normaux‚Äù",
        "msg.normalBody":"Bonjour {patient}, vos mesures du {date} sont normales.",
        "msg.normalSub":"BPM: {bpm} ‚Ä¢ Tension: {bp} ‚Ä¢ SpO‚ÇÇ: {spo2}. Continuez vos habitudes.",
        "msg.watchTitle":"Message ‚Äú√Ä surveiller‚Äù",
        "msg.watchBody":"Bonjour {patient}, certaines valeurs sont √† surveiller ({valeur}).",
        "msg.watchSub":"Merci de refaire une mesure dans 10 minutes au repos. Si cela persiste, contactez le cabinet.",
        "msg.alertTitle":"Message ‚ÄúAlerte‚Äù",
        "msg.alertBody":"Bonjour {patient}, une valeur critique a √©t√© d√©tect√©e ({valeur}).",
        "msg.alertSub":"Merci de contacter imm√©diatement un professionnel de sant√© ou les urgences selon votre √©tat.",
        "msg.reminderTitle":"Message ‚ÄúRappel‚Äù",
        "msg.reminderBody":"Bonjour {patient}, rappel : mesure / contr√¥le pr√©vu le {date} √† {heure}.",
        "msg.reminderSub":"Merci d‚Äô√™tre au repos 5 minutes avant la mesure et d‚Äô√©viter caf√©/effort.",

        "prefs.title":"Pr√©f√©rences",
        "prefs.subtitle":"Th√®me et langue appliqu√©s imm√©diatement.",
        "prefs.themeLight":"Th√®me : Clair",
        "prefs.themeDark":"Th√®me : Sombre",
        "prefs.saved":"Sauvegard√© automatiquement",

        "common.week":"Semaine",
        "common.days7":"7 jours",
        "common.demo":"D√©mo",
        "common.stop":"Stop",
        "common.save":"Enregistrer",
        "common.logs":"Logs",
        "common.recalibrate":"Recalibrer",
        "common.variable":"Variable",

        "status.normal":"Normal",
        "status.watch":"√Ä surveiller",
        "status.alert":"Alerte"
      },

      en: {
        "app.subtitle":"Professional health platform",
        "header.greeting":"Hello, Dr. Victor Mouhammad üëã",
        "header.subline":"Full medical record - Tuesday, Jan 14, 2026",
        "hint":"Tip: use ‚Üê ‚Üí + Enter/Space ‚Ä¢ URL #page",

        "tabs.dashboard":"Dashboard",
        "tabs.sensors":"Sensors",
        "tabs.history":"History",
        "tabs.messages":"Messages",

        "dash.title":"Activity & Heart Rate",
        "dash.subtitle":"Trends summary: daily activity and heart rate.",
        "dash.session":"Active session",
        "dash.export":"Export",
        "dash.hr":"Heart rate",
        "dash.hrSub":"bpm ‚Ä¢ last reading 08:30",
        "dash.activity":"Activity (steps)",
        "dash.activitySub":"steps today ‚Ä¢ goal 8,000",
        "dash.goal":"80% reached",
        "dash.calories":"Estimated calories",
        "dash.caloriesSub":"kcal today ‚Ä¢ estimate",
        "dash.stable":"Stable",
        "dash.hr7":"Heart rate (7 days)",
        "dash.hr7Sub":"Average BPM per day.",
        "dash.act7":"Activity (7 days)",
        "dash.act7Sub":"Steps per day.",

        "sensors.title":"Sensors",
        "sensors.subtitle":"Blood pressure trend (demo). Replace with real values.",
        "sensors.pi":"Raspberry Pi 4",
        "sensors.bpNow":"Current blood pressure",
        "sensors.bpNowSub":"mmHg ‚Ä¢ last update",
        "sensors.bpmDemo":"BPM (demo)",
        "sensors.bpmDemoSub":"instant BPM (example)",
        "sensors.simulated":"Simulated data",
        "sensors.pir":"Presence (PIR)",
        "sensors.none":"None",
        "sensors.pirSub":"motion detection",
        "sensors.bpTrend":"Blood pressure trend",
        "sensors.bpTrendSub":"Systolic / Diastolic (demo).",
        "sensors.diag":"Quick diagnostics",
        "sensors.diagSub":"Results and recommended actions.",
        "sensors.range":"BP expected range",
        "sensors.rangeTip":"Tip: measure again after 2 minutes of rest if elevated.",
        "sensors.pirCheck":"PIR presence",
        "sensors.pirTip":"Tip: avoid heat sources / false motion triggers.",

        "history.title":"Patient history",
        "history.subtitle":"Measurements and events history.",
        "history.exportCsv":"Export CSV",
        "history.patient":"Patient",
        "history.date":"Date",
        "history.bp":"Blood pressure",
        "history.status":"Status",
        "history.notes":"Notes",
        "history.notesSub":"Comments linked to readings.",
        "history.notesBody":"‚Ä¢ Waly: recheck BP after rest, check hydration.<br>‚Ä¢ Binaf: monitor glucose + BP, schedule follow-up.<br>‚Ä¢ Messaoud: stable parameters, continue standard monitoring.",

        "msg.title":"Patient messages",
        "msg.subtitle":"Examples of automated messages (SMS / push / email).",
        "msg.templates":"Templates",
        "msg.normalTitle":"Message ‚ÄúNormal results‚Äù",
        "msg.normalBody":"Hello {patient}, your readings on {date} are normal.",
        "msg.normalSub":"BPM: {bpm} ‚Ä¢ BP: {bp} ‚Ä¢ SpO‚ÇÇ: {spo2}. Keep up your routine.",
        "msg.watchTitle":"Message ‚ÄúNeeds attention‚Äù",
        "msg.watchBody":"Hello {patient}, some values need attention ({valeur}).",
        "msg.watchSub":"Please re-measure in 10 minutes at rest. If it persists, contact the clinic.",
        "msg.alertTitle":"Message ‚ÄúAlert‚Äù",
        "msg.alertBody":"Hello {patient}, a critical value was detected ({valeur}).",
        "msg.alertSub":"Please contact a healthcare professional immediately, or emergency services if needed.",
        "msg.reminderTitle":"Message ‚ÄúReminder‚Äù",
        "msg.reminderBody":"Hello {patient}, reminder: check-up planned on {date} at {heure}.",
        "msg.reminderSub":"Please rest 5 minutes before measuring and avoid coffee/exertion.",

        "prefs.title":"Preferences",
        "prefs.subtitle":"Theme and language apply immediately.",
        "prefs.themeLight":"Theme: Light",
        "prefs.themeDark":"Theme: Dark",
        "prefs.saved":"Saved automatically",

        "common.week":"Week",
        "common.days7":"7 days",
        "common.demo":"Demo",
        "common.stop":"Stop",
        "common.save":"Save",
        "common.logs":"Logs",
        "common.recalibrate":"Recalibrate",
        "common.variable":"Variable",

        "status.normal":"Normal",
        "status.watch":"Watch",
        "status.alert":"Alert"
      }
    };

    // =========================================================
    // THEME + LANGUAGE (persist in localStorage)
    // =========================================================
    const THEME_KEY = "sante_theme";
    const LANG_KEY  = "sante_lang";

    function setTheme(theme){
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem(THEME_KEY, theme);
      // Update select label text (options are translated too)
      document.getElementById("themeSelect").value = theme;
      // Some Chart.js canvases may look better updated
      refreshCharts();
    }

    function setLang(lang){
      document.documentElement.lang = lang;
      localStorage.setItem(LANG_KEY, lang);
      document.getElementById("langSelect").value = lang;
      applyI18n(lang);
    }

    function applyI18n(lang){
      const dict = I18N[lang] || I18N.fr;
      document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        if (!dict[key]) return;
        el.innerHTML = dict[key];
      });

      // Also update theme option texts (since they contain i18n keys)
      document.querySelectorAll("#themeSelect option[data-i18n]").forEach(opt=>{
        const key = opt.getAttribute("data-i18n");
        if (dict[key]) opt.textContent = dict[key];
      });

      // Rebuild charts labels if needed
      rebuildCharts(lang);
    }

    // =========================================================
    // NAVIGATION
    // =========================================================
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const pages = Array.from(document.querySelectorAll('.page'));
    const indicator = document.getElementById('tabIndicator');

    function getActiveTab(){
      return tabs.find(t => t.getAttribute('aria-selected') === 'true') || tabs[0];
    }

    function moveIndicatorTo(tabEl){
      const tabsWrap = tabEl.parentElement;
      const tabRect = tabEl.getBoundingClientRect();
      const wrapRect = tabsWrap.getBoundingClientRect();
      const left = tabRect.left - wrapRect.left;
      indicator.style.width = tabRect.width + 'px';
      indicator.style.transform = 'translateX(' + left + 'px)';
    }

    function setActive(pageName, pushHash = true){
      pages.forEach(p => p.classList.toggle('active', p.id === 'page-' + pageName));
      tabs.forEach(t => t.setAttribute('aria-selected', (t.dataset.page === pageName) ? 'true' : 'false'));
      const activeTab = tabs.find(t => t.dataset.page === pageName);
      if (activeTab) moveIndicatorTo(activeTab);
      if (pushHash) history.replaceState(null, '', '#' + pageName);
    }

    tabs.forEach(t => {
      t.addEventListener('click', () => setActive(t.dataset.page));
      t.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          setActive(t.dataset.page);
        }
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.key !== 'ArrowLeft' && e.key !== 'ArrowRight') return;
      const current = tabs.findIndex(t => t.getAttribute('aria-selected') === 'true');
      if (current < 0) return;
      const next = (e.key === 'ArrowRight')
        ? (current + 1) % tabs.length
        : (current - 1 + tabs.length) % tabs.length;
      tabs[next].focus();
      setActive(tabs[next].dataset.page);
    });

    function initNav(){
      const initial = (location.hash || '#dashboard').replace('#','');
      const exists = pages.some(p => p.id === 'page-' + initial);
      setActive(exists ? initial : 'dashboard', false);
      requestAnimationFrame(() => moveIndicatorTo(getActiveTab()));
      window.addEventListener('resize', () => moveIndicatorTo(getActiveTab()));
    }

    // =========================================================
    // CHARTS
    // =========================================================
    let dashHeartChart = null;
    let dashActivityChart = null;
    let bpChart = null;

    function buildCharts(lang){
      const labelsFR = ['Lun','Mar','Mer','Jeu','Ven','Sam','Dim'];
      const labelsEN = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
      const labels = (lang === 'en') ? labelsEN : labelsFR;

      // Destroy if already exists
      if (dashHeartChart) dashHeartChart.destroy();
      if (dashActivityChart) dashActivityChart.destroy();
      if (bpChart) bpChart.destroy();

      const heartCtx = document.getElementById('dashHeart')?.getContext('2d');
      if (heartCtx) {
        dashHeartChart = new Chart(heartCtx, {
          type: 'line',
          data: {
            labels,
            datasets: [{
              label: 'BPM',
              data: [68,72,70,75,71,73,72],
              borderColor:'#dc2626',
              backgroundColor:'rgba(220,38,38,.08)',
              fill:true,
              tension:.35,
              borderWidth:2,
              pointRadius:3
            }]
          },
          options: { responsive:true, maintainAspectRatio:false, plugins:{ legend:{ display:false } } }
        });
      }

      const actCtx = document.getElementById('dashActivity')?.getContext('2d');
      if (actCtx) {
        dashActivityChart = new Chart(actCtx, {
          type: 'bar',
          data: {
            labels,
            datasets: [{
              label: (lang === 'en') ? 'Steps' : 'Pas',
              data: [5100, 7200, 6400, 8200, 6100, 9000, 7420],
              backgroundColor:'rgba(37,99,235,.35)',
              borderColor:'#2563eb',
              borderWidth:1
            }]
          },
          options: { responsive:true, maintainAspectRatio:false, plugins:{ legend:{ display:false } } }
        });
      }

      const bpCtx = document.getElementById('bpChart')?.getContext('2d');
      if (bpCtx) {
        bpChart = new Chart(bpCtx, {
          type:'line',
          data:{
            labels:['05 Jan','08 Jan','10 Jan','12 Jan','14 Jan'],
            datasets:[
              { label:(lang === 'en') ? 'Systolic' : 'Systolique', data:[118,122,120,119,120], borderColor:'#dc2626', backgroundColor:'rgba(220,38,38,.06)', fill:true, tension:.35, borderWidth:2, pointRadius:3 },
              { label:(lang === 'en') ? 'Diastolic' : 'Diastolique', data:[78,82,80,79,80], borderColor:'#2563eb', backgroundColor:'rgba(37,99,235,.06)', fill:true, tension:.35, borderWidth:2, pointRadius:3 }
            ]
          },
          options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{ display:true, position:'bottom' } } }
        });
      }
    }

    function rebuildCharts(lang){
      // In this file, rebuilding is safe (charts are not huge).
      buildCharts(lang);
    }

    function refreshCharts(){
      // Chart.js uses canvas colors you defined; no hard refresh required.
      // But a rebuild avoids contrast issues if you later customize chart options.
      const lang = localStorage.getItem(LANG_KEY) || "fr";
      rebuildCharts(lang);
    }

    // =========================================================
    // CAPTEURS DEMO
    // =========================================================
    let demoTimer = null;
    let t = 0;

    function setBadge(el, mode){
      if (!el) return;
      el.classList.remove('b-good','b-warn','b-bad','b-info');
      if (mode === 'good') el.classList.add('b-good');
      else if (mode === 'warn') el.classList.add('b-warn');
      else if (mode === 'bad') el.classList.add('b-bad');
      else el.classList.add('b-info');
    }

    function startDemo(){
      stopDemo();
      demoTimer = setInterval(() => {
        t++;

        const bpm = Math.round(70 + 8*Math.sin(t/6) + 2*Math.sin(t/2.2));
        document.getElementById('bpmNow').textContent = bpm;
        document.getElementById('kpiHr').textContent = bpm;

        const sys = Math.round(118 + 6*Math.sin(t/9) + 2*Math.sin(t/3.8));
        const dia = Math.round(78 + 4*Math.sin(t/10) + 2*Math.sin(t/4.1));
        document.getElementById('bpNow').textContent = `${sys}/${dia}`;

        const bpStatus = document.getElementById('bpStatus');
        if (sys >= 140 || dia >= 90) {
          bpStatus.innerHTML = '<i class="fas fa-bell"></i> ' + (document.documentElement.lang === 'en' ? 'High' : '√âlev√©e');
          setBadge(bpStatus, 'bad');
        } else if (sys >= 130 || dia >= 85) {
          bpStatus.innerHTML = '<i class="fas fa-triangle-exclamation"></i> ' + (document.documentElement.lang === 'en' ? 'Watch' : '√Ä surveiller');
          setBadge(bpStatus, 'warn');
        } else {
          bpStatus.innerHTML = '<i class="fas fa-check"></i> ' + (document.documentElement.lang === 'en' ? 'Normal' : 'Normal');
          setBadge(bpStatus, 'good');
        }

        const pir = (Math.random() < 0.08) ? (document.documentElement.lang === 'en' ? 'Motion detected' : 'Mouvement d√©tect√©') : (document.documentElement.lang === 'en' ? 'None' : 'Aucune');
        const pirEl = document.getElementById('pirNow');
        pirEl.textContent = pir;

        const now = new Date();
        const hh = String(now.getHours()).padStart(2,'0');
        const mm = String(now.getMinutes()).padStart(2,'0');
        const ss = String(now.getSeconds()).padStart(2,'0');
        document.getElementById('tick').textContent = `${hh}:${mm}:${ss}`;

      }, 500);
    }

    function stopDemo(){
      if (demoTimer) clearInterval(demoTimer);
      demoTimer = null;
    }

    function bindButtons(){
      const startBtn = document.getElementById('btnStartDemo');
      const stopBtn = document.getElementById('btnStopDemo');
      if (startBtn) startBtn.addEventListener('click', startDemo);
      if (stopBtn) stopBtn.addEventListener('click', stopDemo);
    }

    // =========================================================
    // SETTINGS BINDINGS (theme + lang)
    // =========================================================
    function initPreferences(){
      const themeSelect = document.getElementById("themeSelect");
      const langSelect  = document.getElementById("langSelect");

      // Load saved
      const savedTheme = localStorage.getItem(THEME_KEY) || "light";
      const savedLang  = localStorage.getItem(LANG_KEY)  || "fr";

      themeSelect.value = savedTheme;
      langSelect.value  = savedLang;

      setTheme(savedTheme);
      setLang(savedLang);

      // Apply on change
      themeSelect.addEventListener("change", (e)=> setTheme(e.target.value));
      langSelect.addEventListener("change",  (e)=> setLang(e.target.value));
    }

    // =========================================================
    // INIT
    // =========================================================
    initNav();
    initPreferences();
    buildCharts(localStorage.getItem(LANG_KEY) || "fr");
    bindButtons();
  </script>
</body>
</html>
